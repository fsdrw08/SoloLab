global:
  imageRegistry: zot.day0.sololab
alloy:
  containerPorts: []
  config:
    - component: loki.source.journal
      label: journal
      attributes:
        relabel_rules: loki.relabel.journal.rules
        forward_to: loki.write.loki.receiver
        labels:
          component: '"loki.source.journal"'
    - component: loki.relabel
      label: journal
      attributes:
        forward_to: []
        rule.0:
          source_labels:
            - '"__journal__systemd_unit"'
          target_label: '"systemd_unit"'
        rule.1:
          source_labels:
            - '"__journal__hostname"'
          target_label: '"systemd_hostname"'
        rule.2:
          source_labels:
            - '"__journal__transport"'
          target_label: '"systemd_transport"'
    - component: loki.write
      label: loki
      attributes:
        endpoint:
          url: '"https://loki.day1.sololab/loki/api/v1/push"'
  podLabels:
    traefik.enable: true
    traefik.http.routers.alloy-redirect.entrypoints: web
    traefik.http.routers.alloy-redirect.rule: Host(`alloy.day1.sololab`)
    traefik.http.routers.alloy-redirect.middlewares: toHttps@file
    traefik.http.routers.alloy.entryPoints: webSecure
    traefik.http.routers.alloy.rule: Host(`alloy.day1.sololab`)
    traefik.http.routers.alloy.tls.certresolver: internal
    traefik.http.services.alloy.loadbalancer.server.port: 12345
  extraEnvVars:
    - name: TZ
      value: Asia/Shanghai
